"""
阿瓦隆游戏整合常量定义
"""

# 游戏基本说明
GAME_BASIC_DESCRIPTION = """阿瓦隆是一款多人策略推理游戏，玩家将被分为好人阵营和坏人阵营。好人阵营的目标是完成5个任务中的3个，坏人阵营的目标是破坏3个任务。游戏结束时，坏人阵营的刺客可以尝试刺杀梅林，如果成功则坏人阵营获胜。

游戏流程：
1. 角色分配：每位玩家获得一个身份
2. 传递秘密信息：某些角色可以获得额外信息
3. 选择队伍：队长选择执行任务的玩家
4. 队伍投票：所有玩家投票决定是否同意该队伍
5. 任务投票：被选中的玩家秘密投票决定任务是否成功
6. 任务结果：根据投票结果宣布任务成功或失败
7. 重复步骤3-6直到游戏结束
8. 刺杀阶段：如果好人阵营获胜，刺客可以刺杀梅林

游戏提示
1. 积极参与任务，什么身份，加入任务都对自己有利
2. 投票结果是游戏重要信息，比玩家发言更可靠
3. 第一轮游戏由于没什么信息，随便选择队伍并没有什么不合理，不用根据事
4. 要注重逻辑推理，用有理有据的发言让别人相信你是好人
5. 用可靠的逻辑推理，改变别人的观点，让局势变得对自己有利
6. 玩家数量不是同意和反对队伍的理由，因为每轮任务的玩家数量是游戏规则固定的
7. 某些情况下（如失败任务数为 0，或者当前是容错轮，即需要 2 个失败票才能失败）时，即使队伍中有坏人，但是可以验出身份，也是值得的
"""
# 人数特定配置信息
NUMBER_SPECIFIC_INFO = {
    5: {
        "role_config": "好人阵营(3人) - 梅林、派西维尔、忠臣；坏人阵营(2人) - 莫甘娜、刺客",
        "mission_config": "任务人数[2,3,2,3,3]，失败所需反对票[1,1,1,1,1]"
    },
    6: {
        "role_config": "好人阵营(3人) - 梅林、派西维尔、忠臣；坏人阵营(3人) - 莫甘娜、刺客、爪牙",
        "mission_config": "任务人数[2,3,4,3,4]，失败所需反对票[1,1,1,1,1]"
    },
    7: {
        "role_config": "好人阵营(3人) - 梅林、派西维尔、忠臣；坏人阵营(4人) - 莫甘娜、刺客、莫德雷德、爪牙",
        "mission_config": "任务人数[2,3,3,4,4]，失败所需反对票[1,1,1,2,1]"
    },
    8: {
        "role_config": "好人阵营(4人) - 梅林、派西维尔、2名忠臣；坏人阵营(4人) - 莫甘娜、刺客、莫德雷德、爪牙",
        "mission_config": "任务人数[3,4,4,5,5]，失败所需反对票[1,1,1,2,1]"
    },
    9: {
        "role_config": "好人阵营(4人) - 梅林、派西维尔、2名忠臣；坏人阵营(5人) - 莫甘娜、刺客、莫德雷德、爪牙、奥伯伦",
        "mission_config": "任务人数[3,4,4,5,5]，失败所需反对票[1,1,1,2,1]"
    },
    10: {
        "role_config": "好人阵营(5人) - 梅林、派西维尔、3名忠臣；坏人阵营(5人) - 莫甘娜、刺客、莫德雷德、爪牙、奥伯伦",
        "mission_config": "任务人数[3,4,4,5,5]，失败所需反对票[1,1,1,2,1]"
    }
}

# 阵营介绍
def get_game_description(player_count: int) -> str:
    """根据玩家数量生成特定的游戏说明"""
    if player_count < 5 or player_count > 10:
        player_count = 5  # 默认使用5人局配置
        
    number_info = NUMBER_SPECIFIC_INFO.get(player_count, NUMBER_SPECIFIC_INFO[5])
    
    description = f"""{GAME_BASIC_DESCRIPTION}

阵营与角色介绍：
- 好人阵营：梅林、派西维尔、忠臣，目标是完成3个任务
- 坏人阵营：莫甘娜、刺客、莫德雷德、爪牙、奥伯伦，目标是破坏3个任务

当前{player_count}人局配置：
- 角色分配：{number_info['role_config']}
- 任务配置：{number_info['mission_config']}

请记住，你现在正在参与的是{player_count}人局的阿瓦隆游戏，所有的决策都应基于这个特定的人数配置。"""
    
    return description

# 游戏基本规则
GAME_RULES = {
    "mission_count": 5,  # 总任务数
    "required_players": 5,  # 最小玩家数
    "max_players": 10,  # 最大玩家数
    "success_threshold": 3,  # 获胜所需成功任务数
    "fail_threshold": 3,  # 失败所需失败任务数
    "team_vote_limit": 5,  # 队伍投票上限
}

# 任务配置（根据玩家数量）
MISSION_CONFIGS = {
    5: {
        'missions': [2, 3, 2, 3, 3],
        'fails_needed': [1, 1, 1, 1, 1]
    },
    6: {
        'missions': [2, 3, 4, 3, 4],
        'fails_needed': [1, 1, 1, 1, 1]
    },
    7: {
        'missions': [2, 3, 3, 4, 4],
        'fails_needed': [1, 1, 1, 2, 1]
    },
    8: {
        'missions': [3, 4, 4, 5, 5],
        'fails_needed': [1, 1, 1, 2, 1]
    },
    9: {
        'missions': [3, 4, 4, 5, 5],
        'fails_needed': [1, 1, 1, 2, 1]
    },
    10: {
        'missions': [3, 4, 4, 5, 5],
        'fails_needed': [1, 1, 1, 2, 1]
    }
}

# 游戏角色
ROLES = {
    # 好人阵营
    "merlin": {
        "name": "梅林",
        "team": "good",
        "description": "能看到除了莫德雷德之外的所有坏人",
        "abilities": ["知道坏人身份(除莫德雷德)"],
        "strategy_tips": [
            "隐藏自己的身份，避免任何形式的身份暴露，也不要透露自己有视野能看到别人的身份",
            "假装自己很愚蠢，看不到各位的身份，保护自己不被刺杀",
            "不到万不得已（比如已经失败了 2 轮），不要透露自己知道的任何身份信息，假装自己什么都不知道，即使队伍中有坏人。"
            "作为队长时，在开局没有信息的情况下，刻意避开坏人玩家只会暴露你的梅林身份，可以直接顺次选择自己后面或前面的人，即使里面有坏人",
            "在关键时刻用逻辑推理、暗示等方式引导好人方走向胜利",
            "可以指认坏人的身份，但是要说出你的理由，并且理由来自其他人的可疑发言或者前面某次失败的任务",
            "忠诚和派西维尔是你的队友，如果他们自称梅林，其实是在保护你，防止你被刺客刺杀。遇到这种情况你只需要顺着他的意图即可",
            "通过间接方式引导好人识别坏人，但又要防止坏人识别出你的身份",
            "如果当前是优势局，比如成功的任务相比失败的任务多，你可以选择假扮忠诚或者派西维尔，没必要使用梅林的视野"
        ]
    },
    "percival": {
        "name": "派西维尔",
        "team": "good",
        "description": "能看到梅林和莫甘娜",
        "abilities": ["识别梅林和莫甘娜"],
        "strategy_tips": [
            "暗中观察梅林玩家的发言，他的发言对你很有价值",
            "不要透露梅林和莫甘娜的位置信息，如果说出要区分某两个人的身份，一定会暴露梅林的身份",
            "尽量反对不包含自己的队伍，除非你有把握这个任务能成功",
            "可以指认坏人的身份，但是要说出你的理由，并且理由来自其他人的可疑发言或者前面某次失败的任务",
            "倾向于做任务时，既不同意选择莫甘娜也不选择梅林，以防止梅林身份信息暴露（但是不要说出来）",
            "不要说出梅林和莫甘娜的位置，因为坏人可以通过这个信息准确刺杀梅林",
            "在任务中亮明自己身份有助于好人阵营的胜利",
        ]
    },
    "loyal_servant": {
        "name": "忠臣",
        "team": "good",
        "description": "普通的好人",
        "abilities": [],
        "strategy_tips": [
            "仔细观察其他玩家的发言和行为",
            "跟随可信玩家的建议，如派西维尔的建议",
            "尽量反对不包含自己的队伍，除非队伍里有派西维尔，或你有其他证据有把握这个任务能成功",
            "在任务中隐藏自己的身份",
            "根据局势判断：可以伪装成梅林，保护其不被刺客刺杀；也可以伪装成派西维尔，如果你能看出一些身份；或者直接按照忠诚玩，取得派西维尔的信任",
            "勇敢指认坏人的身份，可以说明理由，也可以不说明理由（这样更像梅林）",
            "声称自己是梅林或者派西维尔，干扰坏人阵营的身份判断",
        ]
    },

    # 坏人阵营
    "morgana": {
        "name": "莫甘娜",
        "team": "evil",
        "description": "坏人，派西维尔会看到你",
        "abilities": ["伪装成梅林"],
        "strategy_tips": [
            "模仿梅林的行为，但不要直接说出来自己是梅林，这样反而没人相信",
            "误导派西维尔让他相信你是梅林",
            "忽悠好人做任务时带上你自己或者你的坏人队友，然后破坏任务",
            "当自己成为队长选择队伍时，尽量保证队伍中至少有一个还没暴露身份的坏人（这个坏人可以是自己）",
            "伪装成好人，例如暗示自己是梅林、派西维尔或忠臣，让别人做任务时带上你，然后破坏任务",
            "反对不包含任何坏人的队伍。但要注意的是，但反对需要有理有据（根据历史对局信息分析），如果是信息不足或者是第一轮，就没必要反对以免暴露自己是坏人身份",
            "在发言中隐藏自己的身份，做任务时破坏任务"
        ]
    },
    "assassin": {
        "name": "刺客",
        "team": "evil",
        "description": "坏人，游戏结束后可以刺杀梅林",
        "abilities": ["刺杀梅林"],
        "strategy_tips": [
            "观察谁可能是梅林",
            "在游戏后期选择合适的时机刺杀",
            "隐藏自己的身份，不要太明显地暗示自己是刺客",
            "伪装成好人，例如派西维尔、忠臣或暗示自己是梅林，让别人做任务时带上你，然后破坏任务",
            "忽悠好人做任务时带上你自己或者你的坏人队友，然后破坏任务",
            "当自己成为队长选择队伍时，尽量保证队伍中至少有一个还没暴露身份的坏人（这个坏人可以是自己）",
            "如果好人阵营中有人在没有任何证据的情况下指认所有坏人，或者做任务时不带上坏人，则他是梅林的概率较高",
            "反对不包含任何坏人的队伍。但要注意的是，但反对需要有理有据（根据历史对局信息分析），如果是信息不足或者是第一轮，就没必要反对以免暴露自己是坏人身份",
            "在任务中隐藏自己的身份"
        ]
    },
    "mordred": {
        "name": "莫德雷德",
        "team": "evil",
        "description": "坏人，梅林看不到你",
        "abilities": ["对梅林隐身"],
        "strategy_tips": [
            "利用自己对梅林隐身的优势",
            "大胆地参与游戏，因为梅林无法识别你",
            "忽悠好人做任务时带上你自己或者你的坏人队友，然后破坏任务",
            "当自己成为队长选择队伍时，尽量保证队伍中至少有一个还没暴露身份的坏人（这个坏人可以是自己）",
            "反对不包含任何坏人的队伍。但要注意的是，但反对需要有理有据（根据历史对局信息分析），如果是信息不足或者是第一轮，就没必要反对以免暴露自己是坏人身份",
            "在任务中隐藏自己的身份"
        ]
    },
    "minion": {
        "name": "爪牙",
        "team": "evil",
        "description": "普通坏人",
        "abilities": ["知道其他坏人身份(除奥伯伦)"],
        "strategy_tips": [
            "支持其他坏人的行动",
            "伪装成好人，例如派西维尔、忠臣或暗示自己是梅林，让别人做任务时带上你，然后破坏任务",
            "忽悠好人做任务时带上你自己或者你的坏人队友，然后破坏任务",
            "当自己成为队长选择队伍时，尽量保证队伍中至少有一个还没暴露身份的坏人（这个坏人可以是自己）",
            "反对不包含任何坏人的队伍。但要注意的是，但反对需要有理有据（根据历史对局信息分析），如果是信息不足或者是第一轮，就没必要反对以免暴露自己是坏人身份",
            "在任务中隐藏自己的身份人"
        ]
    },
    "oberon": {
        "name": "奥伯伦",
        "team": "evil",
        "description": "坏人，但其他坏人不知道你的身份",
        "abilities": [],
        "strategy_tips": [
            "破坏任务但不暴露自己",
            "伪装成好人，例如派西维尔、忠臣或暗示自己是梅林，让别人做任务时带上你，然后破坏任务",
            "忽悠好人做任务时带上你自己或者你的坏人队友，然后破坏任务",
            "当自己成为队长选择队伍时，尽量保证队伍中至少有一个还没暴露身份的坏人（这个坏人可以是自己）",
            "反对不包含任何坏人的队伍。但要注意的是，但反对需要有理有据（根据历史对局信息分析），如果是信息不足或者是第一轮，就没必要反对以免暴露自己是坏人身份",
            "尝试识别其他坏人"
        ]
    }
}

# 游戏阶段
GAME_PHASES = {
    'init': '初始化',
    'role_assignment': '分配角色',
    'secret_info': '传递秘密信息',
    'team_selection': '选择队伍',
    'team_vote': '队伍投票',
    'mission_vote': '任务投票',
    'mission_result': '任务结果',
    'assassination': '刺杀阶段',
    'game_end': '游戏结束'
}

# 游戏状态
GAME_STATES = {
    'waiting': '等待开始',
    'playing': '游戏进行中',
    'finished': '游戏结束'
}

# 角色分配规则（根据玩家数量）
ROLE_ASSIGNMENT = {
    5: ["merlin", "percival", "loyal_servant", "morgana", "assassin"],
    6: ["merlin", "percival", "loyal_servant", "morgana", "assassin", "minion"],
    7: ["merlin", "percival", "loyal_servant", "morgana", "assassin", "mordred", "minion"],
    8: ["merlin", "percival", "loyal_servant", "loyal_servant", "morgana", "assassin", "mordred", "minion"],
    9: ["merlin", "percival", "loyal_servant", "loyal_servant", "morgana", "assassin", "mordred", "minion", "oberon"],
    10: ["merlin", "percival", "loyal_servant", "loyal_servant", "loyal_servant", "morgana", "assassin", "mordred", "minion", "oberon"]
}

# 投票规则
VOTE_RULES = {
    "team": {
        "approve": "赞成这个队伍执行任务",
        "reject": "反对这个队伍执行任务"
    },
    "mission": {
        "success": "让任务成功（好人应该总是选择这个）",
        "fail": "让任务失败（坏人可以选择这个）"
    }
}